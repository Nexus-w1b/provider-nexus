<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIRZA NEXUS </title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lucide-react/0.263.1/lucide-react.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&display=swap');

        :root {
            --accent-glow: rgba(99, 102, 241, 0.5);
            --bg-dark: #0a0b14;
            --card-bg: #161827;
            --primary-gradient: linear-gradient(135deg, #6366f1 0%, #a855f7 100%);
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: var(--bg-dark);
            color: #e2e8f0;
            margin: 0;
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
        }

        /* Responsive Fix for iOS Safe Areas */
        .safe-area-top { padding-top: env(safe-area-inset-top); }
        .safe-area-bottom { padding-bottom: env(safe-area-inset-bottom); }

        .glass-card {
            background: rgba(30, 32, 50, 0.7);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 24px;
        }

        .active-glow {
            box-shadow: 0 0 20px var(--accent-glow);
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 10px; }

        .typing-cursor::after {
            content: "|";
            animation: blink 1s infinite;
        }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0; } }

        /* Animation for portal transition */
        .fade-in { animation: fadeIn 0.4s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Mobile specific layout fixes */
        @media (max-width: 768px) {
            .grid-cols-custom { grid-template-columns: repeat(2, 1fr); }
            .chat-container { height: calc(100vh - 180px); }
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- App Container -->
    <div id="app" class="flex flex-col flex-1 h-screen overflow-hidden relative">
        
        <!-- HEADER -->
        <header class="safe-area-top p-4 flex justify-between items-center z-50">
            <div class="flex flex-col">
                <h1 class="text-2xl font-extrabold tracking-tighter italic text-white flex items-center gap-2">
                    VIRZA NEXUS <span class="text-indigo-500">V12</span>
                </h1>
                <p id="status-text" class="text-[10px] uppercase tracking-widest text-indigo-400 font-bold flex items-center gap-1">
                    <span class="w-1.5 h-1.5 bg-indigo-500 rounded-full animate-pulse"></span>
                    Cloud Database Active
                </p>
            </div>
            <div class="flex items-center gap-3">
                <button onclick="toggleHistory()" class="p-2.5 rounded-2xl glass-card text-white hover:bg-indigo-600 transition-all">
                    <i data-lucide="history" class="w-5 h-5"></i>
                </button>
                <button onclick="toggleSettings()" class="p-2.5 rounded-2xl glass-card text-white hover:bg-indigo-600 transition-all">
                    <i data-lucide="settings-2" class="w-5 h-5"></i>
                </button>
            </div>
        </header>

        <!-- MAIN VIEW (DYNAMIC) -->
        <main id="main-content" class="flex-1 overflow-y-auto px-4 pb-24 fade-in">
            <!-- Home View -->
            <div id="view-home">
                <!-- Lockscreen/Welcome Banner -->
                <div class="mt-4 mb-8 glass-card p-6 flex items-center justify-between border-l-4 border-indigo-500">
                    <div>
                        <p id="current-date" class="text-xs font-bold text-indigo-300 uppercase mb-1">RABU, 18 FEB 2026</p>
                        <h2 id="current-time" class="text-4xl font-black italic">11.38.25</h2>
                        <p class="text-sm mt-2 opacity-70">Hi, <span class="text-white font-bold">MANTUSI ROBOTIK</span></p>
                    </div>
                    <div class="w-14 h-14 rounded-full bg-gradient-to-tr from-indigo-600 to-purple-500 flex items-center justify-center text-xl font-bold border-2 border-white/20 active-glow">
                        M
                    </div>
                </div>

                <!-- Search Bar -->
                <div class="relative mb-8">
                    <input type="text" placeholder="Pencarian Dimensi Utama..." class="w-full bg-white/5 border border-white/10 rounded-2xl py-4 pl-12 pr-4 outline-none focus:ring-2 focus:ring-indigo-500/50 transition-all">
                    <i data-lucide="search" class="w-5 h-5 absolute left-4 top-1/2 -translate-y-1/2 text-gray-400"></i>
                </div>

                <!-- Portal Grid -->
                <div class="grid grid-cols-2 md:grid-cols-3 gap-4 mb-10">
                    <button onclick="openPortal('architect')" class="glass-card p-6 flex flex-col items-center gap-3 hover:scale-[1.02] transition-transform group">
                        <div class="w-14 h-14 rounded-2xl bg-indigo-500/20 flex items-center justify-center group-hover:bg-indigo-500/40">
                            <i data-lucide="code-2" class="w-7 h-7 text-indigo-400"></i>
                        </div>
                        <span class="text-[10px] font-black uppercase tracking-widest text-gray-400">Architect</span>
                    </button>

                    <button onclick="openPortal('image')" class="glass-card p-6 flex flex-col items-center gap-3 hover:scale-[1.02] transition-transform group">
                        <div class="w-14 h-14 rounded-2xl bg-pink-500/20 flex items-center justify-center group-hover:bg-pink-500/40">
                            <i data-lucide="image" class="w-7 h-7 text-pink-400"></i>
                        </div>
                        <span class="text-[10px] font-black uppercase tracking-widest text-gray-400">Image HD</span>
                    </button>

                    <button onclick="openPortal('chat')" class="glass-card p-6 flex flex-col items-center gap-3 hover:scale-[1.02] transition-transform group border-2 border-indigo-500/50 active-glow">
                        <div class="w-14 h-14 rounded-2xl bg-emerald-500/20 flex items-center justify-center group-hover:bg-emerald-500/40">
                            <i data-lucide="message-square" class="w-7 h-7 text-emerald-400"></i>
                        </div>
                        <span class="text-[10px] font-black uppercase tracking-widest text-white">Smart AI</span>
                    </button>

                    <button onclick="openPortal('vision')" class="glass-card p-6 flex flex-col items-center gap-3 hover:scale-[1.02] transition-transform group">
                        <div class="w-14 h-14 rounded-2xl bg-amber-500/20 flex items-center justify-center group-hover:bg-amber-500/40">
                            <i data-lucide="eye" class="w-7 h-7 text-amber-400"></i>
                        </div>
                        <span class="text-[10px] font-black uppercase tracking-widest text-gray-400">Vision Pro</span>
                    </button>

                    <button onclick="openPortal('weaver')" class="glass-card p-6 flex flex-col items-center gap-3 hover:scale-[1.02] transition-transform group">
                        <div class="w-14 h-14 rounded-2xl bg-blue-500/20 flex items-center justify-center group-hover:bg-blue-500/40">
                            <i data-lucide="globe" class="w-7 h-7 text-blue-400"></i>
                        </div>
                        <span class="text-[10px] font-black uppercase tracking-widest text-gray-400">Web Weaver</span>
                    </button>

                    <button class="glass-card p-6 flex flex-col items-center gap-3 opacity-50">
                        <div class="w-14 h-14 rounded-2xl bg-red-500/20 flex items-center justify-center">
                            <i data-lucide="shield" class="w-7 h-7 text-red-400"></i>
                        </div>
                        <span class="text-[10px] font-black uppercase tracking-widest text-gray-400">Nexus Guard</span>
                    </button>
                </div>

                <div class="flex justify-center mb-10">
                    <button class="bg-red-950/40 border border-red-500/30 text-red-500 px-6 py-3 rounded-2xl text-[10px] font-black tracking-widest uppercase flex items-center gap-2">
                        <i data-lucide="power" class="w-4 h-4"></i> Terminasi Protokol
                    </button>
                </div>
            </div>

            <!-- Portal View (Architect/Chat/etc) -->
            <div id="view-portal" class="hidden h-full flex flex-col">
                <div class="flex items-center gap-3 mb-6">
                    <button onclick="goHome()" class="p-2 rounded-xl bg-white/5 hover:bg-white/10">
                        <i data-lucide="arrow-left" class="w-5 h-5 text-indigo-400"></i>
                    </button>
                    <h2 id="portal-title" class="text-xl font-bold italic uppercase tracking-tighter text-white">PORTAL AI</h2>
                </div>

                <!-- Dual View (For Website) -->
                <div id="dual-view-container" class="hidden flex-1 flex flex-col md:flex-row gap-4 mb-4 h-[500px]">
                    <div class="flex-1 glass-card overflow-hidden flex flex-col">
                        <div class="p-2 border-b border-white/5 bg-white/5 text-[10px] font-bold uppercase tracking-widest">Neural Code</div>
                        <textarea id="neural-editor" class="flex-1 bg-transparent p-4 font-mono text-sm outline-none resize-none" placeholder="HTML/CSS logic..."></textarea>
                    </div>
                    <div class="flex-1 glass-card overflow-hidden flex flex-col bg-white">
                        <div class="p-2 border-b border-black/5 bg-black/5 text-[10px] font-bold uppercase tracking-widest text-black">Live Preview</div>
                        <iframe id="live-preview" class="flex-1 w-full border-none"></iframe>
                    </div>
                </div>

                <!-- Chat Display -->
                <div id="chat-messages" class="flex-1 overflow-y-auto space-y-4 mb-4 pr-2">
                    <div class="flex flex-col gap-1 max-w-[80%]">
                        <div class="p-4 rounded-2xl rounded-tl-none glass-card text-sm leading-relaxed">
                            Sistem diaktifkan. Berikan instruksi neural Anda untuk inisialisasi dimensi.
                        </div>
                        <span class="text-[9px] text-indigo-400 ml-1">SYSTEM 11:38</span>
                    </div>
                </div>

                <!-- Chat Input Area -->
                <div class="safe-area-bottom pb-4">
                    <div class="glass-card p-2 flex flex-col gap-2 shadow-2xl">
                        <div id="attachment-preview" class="hidden flex gap-2 p-2 border-b border-white/10"></div>
                        <div class="flex items-end gap-2">
                            <div class="flex gap-1 pb-1">
                                <button onclick="triggerFile('image')" class="p-2 text-gray-400 hover:text-indigo-400"><i data-lucide="image" class="w-5 h-5"></i></button>
                                <button onclick="triggerFile('file')" class="p-2 text-gray-400 hover:text-indigo-400"><i data-lucide="paperclip" class="w-5 h-5"></i></button>
                            </div>
                            <textarea id="neural-input" rows="1" class="flex-1 bg-transparent py-3 px-2 outline-none text-sm resize-none" placeholder="Ketik instruksi neural..."></textarea>
                            <button onclick="sendNeural()" class="p-3 bg-indigo-600 rounded-xl hover:bg-indigo-500 active:scale-95 transition-all text-white active-glow">
                                <i data-lucide="send" class="w-5 h-5"></i>
                            </button>
                        </div>
                    </div>
                    <!-- Performance Toggle (Gemini Style) -->
                    <div class="flex justify-between items-center px-2 mt-3">
                        <div class="flex items-center gap-4">
                            <label class="flex items-center gap-2 text-[10px] font-bold uppercase cursor-pointer">
                                <input type="radio" name="speed" value="fast" checked class="accent-indigo-500"> Flash
                            </label>
                            <label class="flex items-center gap-2 text-[10px] font-bold uppercase cursor-pointer">
                                <input type="radio" name="speed" value="pro" class="accent-purple-500"> Pro
                            </label>
                        </div>
                        <span class="text-[9px] text-gray-500 italic">Nexus Core Engine v12.4</span>
                    </div>
                </div>
            </div>
        </main>

        <!-- SLIDE OVER: HISTORY -->
        <div id="history-panel" class="fixed inset-y-0 right-0 w-[85%] md:w-[400px] glass-card rounded-r-none translate-x-full transition-transform duration-300 z-[100] flex flex-col">
            <div class="p-6 border-b border-white/10 flex items-center justify-between">
                <h3 class="text-lg font-black italic uppercase italic">Neural History</h3>
                <button onclick="toggleHistory()" class="text-gray-400"><i data-lucide="x" class="w-6 h-6"></i></button>
            </div>
            <div class="flex-1 overflow-y-auto p-4 space-y-3" id="history-list">
                <!-- User History -->
                <div class="p-4 rounded-2xl bg-white/5 border border-white/5 hover:border-indigo-500/50 cursor-pointer transition-all">
                    <p class="text-[10px] text-indigo-400 font-bold mb-1">ARCHITECT • 2 MIN LALU</p>
                    <p class="text-sm font-semibold truncate">Build responsive dashboard using Tailwind...</p>
                </div>
            </div>
        </div>

        <!-- SLIDE OVER: SETTINGS / API KEY -->
        <div id="settings-panel" class="fixed inset-y-0 right-0 w-[85%] md:w-[400px] glass-card rounded-r-none translate-x-full transition-transform duration-300 z-[100] flex flex-col">
            <div class="p-6 border-b border-white/10 flex items-center justify-between">
                <h3 class="text-lg font-black italic uppercase italic">Nexus Config</h3>
                <button onclick="toggleSettings()" class="text-gray-400"><i data-lucide="x" class="w-6 h-6"></i></button>
            </div>
            <div class="p-6 space-y-8">
                <div>
                    <label class="text-[10px] font-bold uppercase tracking-widest text-indigo-400 block mb-3">Google Gemini API Key</label>
                    <div class="relative">
                        <input type="password" id="api-key-input" placeholder="Masukkan Key Anda..." class="w-full bg-white/5 border border-white/10 rounded-2xl py-4 px-4 outline-none focus:ring-2 focus:ring-indigo-500/50 transition-all font-mono text-xs">
                    </div>
                    <button onclick="saveApiKey()" class="w-full mt-4 bg-indigo-600 py-4 rounded-2xl font-black uppercase text-xs tracking-widest shadow-lg active-glow">Save Neural Key</button>
                    <p class="text-[9px] text-gray-500 mt-2 italic text-center">Key disimpan secara lokal untuk sesi ini.</p>
                </div>
                
                <div class="space-y-4">
                    <h4 class="text-[10px] font-bold uppercase text-gray-400 tracking-widest">Display Preferences</h4>
                    <div class="flex items-center justify-between glass-card p-4">
                        <span class="text-sm">High Contrast Mode</span>
                        <input type="checkbox" class="w-5 h-5 accent-indigo-500" checked>
                    </div>
                    <div class="flex items-center justify-between glass-card p-4">
                        <span class="text-sm">Neural Animations</span>
                        <input type="checkbox" class="w-5 h-5 accent-indigo-500" checked>
                    </div>
                </div>
            </div>
        </div>

        <div id="overlay" onclick="closeAllPanels()" class="fixed inset-0 bg-black/60 backdrop-blur-sm z-[90] hidden"></div>
        
        <input type="file" id="file-input" class="hidden" multiple>

         </div>

    <script>
        // Initialize Lucide Icons
        lucide.createIcons();

        // State Management
        let currentView = 'home';
        let activePortal = null;
        let apiKey = '';

        // Time Updates
        function updateTime() {
            const now = new Date();
            const timeStr = now.getHours().toString().padStart(2, '0') + '.' + 
                            now.getMinutes().toString().padStart(2, '0') + '.' + 
                            now.getSeconds().toString().padStart(2, '0');
            document.getElementById('current-time').innerText = timeStr;
            
            const days = ['MINGGU', 'SENIN', 'SELASA', 'RABU', 'KAMIS', 'JUMAT', 'SABTU'];
            const months = ['JAN', 'FEB', 'MAR', 'APR', 'MEI', 'JUN', 'JUL', 'AGU', 'SEP', 'OKT', 'NOV', 'DES'];
            const dateStr = `${days[now.getDay()]}, ${now.getDate()} ${months[now.getMonth()]} ${now.getFullYear()}`;
            document.getElementById('current-date').innerText = dateStr;
        }
        setInterval(updateTime, 1000);
        updateTime();

        // Navigation
        function openPortal(type) {
            currentView = 'portal';
            activePortal = type;
            document.getElementById('view-home').classList.add('hidden');
            document.getElementById('view-portal').classList.remove('hidden');
            
            const titles = {
                'architect': 'Nexus Architect',
                'image': 'Visual Engine HD',
                'chat': 'Nexus Smart AI',
                'vision': 'Vision Analysis',
                'weaver': 'Web Weaver'
            };
            document.getElementById('portal-title').innerText = titles[type];
            
            // Toggle Dual View for Architect/Weaver
            const isWeb = type === 'architect' || type === 'weaver';
            document.getElementById('dual-view-container').classList.toggle('hidden', !isWeb);
            
            // Clear chat for fresh start
            const chatBox = document.getElementById('chat-messages');
            chatBox.innerHTML = `
                <div class="flex flex-col gap-1 max-w-[80%] fade-in">
                    <div class="p-4 rounded-2xl rounded-tl-none glass-card text-sm leading-relaxed">
                        Protokol ${titles[type]} diaktifkan. Apa yang ingin Anda kembangkan sekarang?
                    </div>
                    <span class="text-[9px] text-indigo-400 ml-1">SYSTEM ${new Date().getHours()}:${new Date().getMinutes()}</span>
                </div>
            `;
        }

        function goHome() {
            document.getElementById('view-home').classList.remove('hidden');
            document.getElementById('view-portal').classList.add('hidden');
            currentView = 'home';
        }

        // Panel Controls
        function toggleHistory() {
            const panel = document.getElementById('history-panel');
            const overlay = document.getElementById('overlay');
            panel.classList.toggle('translate-x-full');
            overlay.classList.toggle('hidden');
        }

        function toggleSettings() {
            const panel = document.getElementById('settings-panel');
            const overlay = document.getElementById('overlay');
            panel.classList.toggle('translate-x-full');
            overlay.classList.toggle('hidden');
        }

        function closeAllPanels() {
            document.getElementById('history-panel').classList.add('translate-x-full');
            document.getElementById('settings-panel').classList.add('translate-x-full');
            document.getElementById('overlay').classList.add('hidden');
        }

        // Chat Fungsionalitas
        const inputField = document.getElementById('neural-input');
        inputField.addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = (this.scrollHeight) + 'px';
        });

        function sendNeural() {
            const text = inputField.value.trim();
            if(!text) return;

            // Add User Bubble
            addMessage('user', text);
            inputField.value = '';
            inputField.style.height = 'auto';

            // Simulate System Response
            setTimeout(() => {
                const response = getSimulatedResponse(text);
                addMessage('system', response);
                
                // If it's a code request, update preview
                if(activePortal === 'architect' || activePortal === 'weaver') {
                    updatePreview(text);
                }
            }, 800);
        }

        function addMessage(sender, text) {
            const chatBox = document.getElementById('chat-messages');
            const div = document.createElement('div');
            const time = new Date().getHours() + ':' + new Date().getMinutes();
            
            if(sender === 'user') {
                div.className = 'flex flex-col gap-1 items-end ml-auto max-w-[85%] fade-in';
                div.innerHTML = `
                    <div class="p-4 rounded-2xl rounded-tr-none bg-indigo-600 text-white text-sm leading-relaxed shadow-lg">
                        ${text}
                    </div>
                    <span class="text-[9px] text-gray-500 mr-1">YOU ${time}</span>
                `;
            } else {
                div.className = 'flex flex-col gap-1 max-w-[85%] fade-in';
                div.innerHTML = `
                    <div class="p-4 rounded-2xl rounded-tl-none glass-card text-sm leading-relaxed border-l-2 border-indigo-500">
                        <div class="typing-text">${text}</div>
                    </div>
                    <span class="text-[9px] text-indigo-400 ml-1">NEXUS ${time}</span>
                `;
            }
            
            chatBox.appendChild(div);
            chatBox.scrollTop = chatBox.scrollHeight;

            // Add to history
            if(sender === 'user') {
                const histList = document.getElementById('history-list');
                const hDiv = document.createElement('div');
                hDiv.className = 'p-4 rounded-2xl bg-white/5 border border-white/5 hover:border-indigo-500/50 cursor-pointer transition-all';
                hDiv.innerHTML = `<p class="text-[10px] text-indigo-400 font-bold mb-1 uppercase">${activePortal} • BARU SAJA</p><p class="text-sm font-semibold truncate">${text}</p>`;
                histList.prepend(hDiv);
            }
        }

        function getSimulatedResponse(text) {
            if(text.toLowerCase().includes('buatkan') || text.toLowerCase().includes('website')) {
                return "Permintaan diterima. Menghasilkan struktur neural untuk komponen website Anda. Lihat panel preview di atas untuk hasil langsung.";
            }
            if(text.toLowerCase().includes('halo') || text.toLowerCase().includes('hi')) {
                return "Halo Master Mantusi! Protokol Nexus V12 siap membantu. Dimensi mana yang ingin Anda jelajahi hari ini?";
            }
            return "Analisis instruksi selesai. Melakukan pemrosesan data di Cloud Database... " + (apiKey ? "Menggunakan API Gemini Pro." : "Berjalan dalam mode simulasi (API Key belum diatur).");
        }

        function updatePreview(text) {
            const preview = document.getElementById('live-preview');
            const editor = document.getElementById('neural-editor');
            
            // Mock code generation
            const mockCode = `
                <html>
                    <style>
                        body { background: #000; color: #fff; display: flex; align-items: center; justify-content: center; height: 100vh; font-family: sans-serif; }
                        .card { border: 2px solid #6366f1; padding: 20px; border-radius: 15px; text-align: center; }
                    </style>
                    <body>
                        <div class="card">
                            <h1>Hasil Neural Weaver</h1>
                            <p>Instruksi: "${text}"</p>
                            <small>Nexus v12 Live Preview</small>
                        </div>
                    </body>
                </html>
            `;
            
            editor.value = mockCode;
            const blob = new Blob([mockCode], {type: 'text/html'});
            preview.src = URL.createObjectURL(blob);
        }

        // File Attachment Handling
        function triggerFile(type) {
            const input = document.getElementById('file-input');
            input.accept = type === 'image' ? 'image/*' : '*/*';
            input.click();
        }

        document.getElementById('file-input').addEventListener('change', function(e) {
            const preview = document.getElementById('attachment-preview');
            preview.classList.remove('hidden');
            preview.innerHTML = '';
            
            Array.from(this.files).forEach(file => {
                const chip = document.createElement('div');
                chip.className = 'flex items-center gap-2 bg-indigo-500/20 px-3 py-1.5 rounded-full text-[10px] border border-indigo-500/30';
                chip.innerHTML = `<i data-lucide="file" class="w-3 h-3"></i> ${file.name.substring(0, 10)}...`;
                preview.appendChild(chip);
            });
            lucide.createIcons();
        });

        // API Key Storage
        function saveApiKey() {
            const val = document.getElementById('api-key-input').value;
            if(val) {
                apiKey = val;
                localStorage.setItem('nexus_gemini_key', val);
                const btn = event.target;
                btn.innerText = "KEY SAVED!";
                btn.classList.add('bg-emerald-600');
                setTimeout(() => {
                    btn.innerText = "Save Neural Key";
                    btn.classList.remove('bg-emerald-600');
                    toggleSettings();
                }, 1500);
            }
        }

  // Load saved key if exists
        window.onload = () => {
            const saved = localStorage.getItem('nexus_gemini_key');
            if(saved) {
                apiKey = saved;
                document.getElementById('api-key-input').value = saved;
            }
        };

    </script>
</body>
</html>
